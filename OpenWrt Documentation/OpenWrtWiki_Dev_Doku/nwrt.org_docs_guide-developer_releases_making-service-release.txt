====== How to create a service release ======
<WRAP round info 30%>
See also [[docs:guide-developer:releases:release-process]] for more general guidance.
</WRAP>

===== 0) Prerequisites =====

  * Fetch maintainer scripts from https://git.openwrt.org/maintainer-tools.git
  * Ensure that GPG and usign keys are published and working according to https://openwrt.org/docs/guide-user/security/keygen

===== 1) Prepare release tag =====

  * Fetch pristine source tree, best do a new local clone, e.g. <code>git clone git@git.openwrt.org:openwrt/openwrt.git
git checkout openwrt-19.07</code>
     * Replace branch name with appropriate one
  * Place ''maketag.sh'' script from maintainer repo into the clone
  * Execute ''./maketag.sh -k 818021EBB6C9ECDA -v 19.07.0''
    * Replace key ID and version number with appropriate values
  * Review auto generated commits with ''git log -p -2''
    * Should show one setting adjustment and one setting revert commit
  * Review auto generated tag with ''git show v19.07.0''
    * Should show a git tag with associated GPG info and commit references
    * Replace version number accordingly
  * Push auto generated commits and tag to the remote: <code>git push origin openwrt-19.07
git push --follow-tags origin refs/tags/v19.07.0:refs/tags/v19.07.0</code>
    * Replace version numbers and branch name accordingly
    * Review https://git.openwrt.org/?p=openwrt/openwrt.git;a=tags

===== 2) Trigger builds =====

  * Log into http://buildbot.openwrt.org/openwrt-19.07/images
    * Use credentials provided by admin
  * Open the "Builders" page
    * Scroll down to "Force All Builds" form
  * Fill out the form
    * Enter "Trigger release builds" as reason
    * In the first "Name:" field enter ''tag''
    * In the first "Value:" field enter ''19.07.0''
      * Replace version number accordingly
      * Note the missing ''v'' prefix! Enter only the number
    * Click "Force Build"
  * Review buildbot activity in waterfall view

===== 3) Create changelogs =====

  * Copy ''make-changelog.pl'' from maintainer repo into the local clone
  * Execute ''./make-changelog.pl v19.07.0..v19.07.1''
    * Replace version numbers accordingly
    * Revision range should cover all commits since last release
    * Suggest to redirect stdout to a file
  * Copy resulting change log into https://openwrt.org/releases/19.07/changelog-19.07.0
    * Replace base and minor versions accordingly
    * Take care to preserve the first introductory paragraph in the wiki pages
    * Ideally use a prior change log page as template

===== 4) Update release information page =====

  * Once the release builds are finished and uploaded to https://downloads.openwrt.org/releases/19.07.0/targets/ ...
  * ... head to release series parent page at https://openwrt.org/releases/19.07/start
    * Replace base version accordingly if needed
  * Update timeline and latest version number, links etc. to point to the latest release
  * Start preparing release notes at https://openwrt.org/releases/19.07/notes-19.07.0
    * Replace version accordingly
    * Mention most important changes since last release
    * Use old release note pages as template
    * Good technique is to skim through detailed change log and taking note of outstanding commits or series of commits

===== 5) Announce =====

  * Write an announcement to the mailing lists
    * Use http://lists.infradead.org/pipermail/openwrt-devel/2017-October/009401.html as template
  * Write an announcement in the forum
    * Use https://forum.openwrt.org/t/lede-v17-01-4-service-release/7573 as template
    * "Pin" the topic for 4-8 weeks
  * Update IRC channel topics

