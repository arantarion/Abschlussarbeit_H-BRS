====== luci-app-statistics ====== 

Out of the box, OpenWRT can show you real-time statistics, however it will not store the data for historical view.
Install luci-app-statistics to have a nice historical data graphs for router, eg: ping, interfaces bandwidth utilization, cpu load, ram, disk, uptime, etcâ€¦

To see all the available collectd-modules, run: ''opkg list | grep collectd-mod''

I've found the original description located at: [[https://advanxer.com/blog/2013/02/openwrt-monitoring-using-collectd/]]
Thanks to advanxer.com!

===== collectd+rrdtool =====

luci-app-statistics is a collectd and rrdtool based statistics tool. For more details about collectd and rrdtool, see [[docs:guide-user:perf_and_log:statistical.data.overview]]

For other Bandwidth Monitoring tools, see [[docs:guide-user:services:network_monitoring:bwmon|bwmon]]

===== Installation =====

The luci-app-statistics package is based on Collectd and uses RRD Tool to render diagram images from collected data.

1. opkg update and install (326 KB)
  opkg update
  opkg install luci-app-statistics

2. Install desired plugins (60 KB)
  opkg list | grep collectd-mod
  opkg install collectd-mod-cpu collectd-mod-interface collectd-mod-memory collectd-mod-ping collectd-mod-rrdtool collectd-mod-wireless

3. Enable daemons
  /etc/init.d/luci_statistics enable
  /etc/init.d/collectd enable

4. Create default rrd directory
  mkdir /tmp/rrd
  chown -R nobody:nogroup /tmp/rrd

This creates default data directory. Without this directory, you will not have any graphs out of the box.
Note that the directory resides in ramdisk. Graphs and data are lost after a reboot. It is also a good idea
to add the comments above to ''/etc/rc.local'' to create the directory after a reboot.

Instead, you can also configure a persistent storage location - see below.

===== Configuration =====

__Configuration via UCI:__ 
  * View the config with ''uci export luci_statistics'' 
  * Edit ''/etc/config/luci_statistics'' to make changes.

__Configuration via LuCI:__ After installing the packages, a new menu appears. See the config pages in **Statistics->Setup** All the installed collectd-modules will shown here, but only some of them are enabled by default.

==== Suggested configuration ====

  * **General Plugins tab:** Review the sub-tabs to choose which statistics to monitor
  * **Network Plugins tab:** Select which interfaces to monitor
  * **Output Plugins tab:** 
    * __RRDtool sub-tab:__ To protect flash-memory from wearing out, the default //Storage directory// is ''/tmp/rrd''. All statistics data will be lost on reboot. Alternatives:
      * Consider having an automatic backup-restore script that runs when rebooting (e.g. [[https://gist.github.com/squarewf/a2347fe44e217a19998eb2b6b1b16c59|script by squarewf]]).
      * If you have a USB drive connected, set the //Storage directory// to a directory on that drive. //NB Since pages are rendered by user 'nobody', the *.rrd files, the storage directory and all its parent directories need to be world readable. See https://forum.openwrt.org/t/trouble-with-luci-app-statistics-using-storage-directory-on-usb-drive/10683/4 //
      * Or use the //Network sub-tab// to send the statistics to another router/device that's acting as a collectd network listener.
    * __Network sub-tab:__ collectd can either listen for other router's data, or send its data to other routers 

