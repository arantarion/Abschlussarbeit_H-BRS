====== OpenVPN client ======
{{section>meta:infobox:howto_links#cli_skills&noheader&nofooter&noeditbutton}}

===== Introduction =====
  * This how-to describes the method for setting up [[wp>OpenVPN|OpenVPN]] client on OpenWrt.
  * Follow [[docs:guide-user:services:vpn:openvpn:server|OpenVPN server]] for server setup and [[docs:guide-user:services:vpn:openvpn:extras|OpenVPN extras]] for additional tuning.

===== Goals =====
{{section>docs:guide-user:services:vpn:wireguard:server#goals&noheader&nofooter&noeditbutton}}

===== Instructions =====
==== 1. Preparation ====
Install the packages and specify the VPN client configuration parameters.

<code bash>
# Install packages
opkg update
opkg install openvpn-openssl

# Configuration parameters
OVPN_DIR="/etc/openvpn"
OVPN_ID="client"
</code>

==== 2. Firewall ====
Consider VPN network as public and assign VPN interface to WAN zone to minimize firewall setup.

<code bash>
# Configure firewall
uci rename firewall.@zone[0]="lan"
uci rename firewall.@zone[1]="wan"
uci del_list firewall.wan.device="tun+"
uci add_list firewall.wan.device="tun+"
uci commit firewall
/etc/init.d/firewall restart
</code>

==== 3. VPN service ====
Save your client profile and configure VPN service.
Drop VPN service privileges and ensure VPN interface name matches firewall configuration.

<code bash>
# Save VPN client profile
umask go=
cat << "EOF" > ${OVPN_DIR}/${OVPN_ID}.conf
COPY_PASTE_CLIENT_PROFILE_HERE
EOF

# Configure VPN service
sed -i -e "
/^user/s/^/#/
\$a user nobody
/^group/s/^/#/
\$a group nogroup
" ${OVPN_DIR}/${OVPN_ID}.conf
/etc/init.d/openvpn restart
</code>

Configure credentials for [[docs:guide-user:services:vpn:openvpn:extras#commercial_provider|commercial provider]] if required.

===== Testing =====
{{section>docs:guide-user:services:vpn:wireguard:server#testing&noheader&nofooter&noeditbutton}}

===== Troubleshooting =====
{{section>docs:guide-user:services:vpn:openvpn:server#troubleshooting&noheader&nofooter&noeditbutton}}
